# Анализ блокировки Instagram

## Проблема

Пользователь сообщает, что:
- ✅ Обновление профиля через прокси **работает** на проде
- ❌ Авторизация новых аккаунтов через прокси **не работает**

## Вывод

**Instagram блокирует ТОЛЬКО endpoint авторизации `/api/v1/accounts/login/` для автоматизированных запросов.**

### Что работает:
- ✅ Обновление профиля (`account_edit`)
- ✅ Изменение приватности (`account_set_private/public`)
- ✅ Публикация постов (`photo_upload`)
- ✅ Получение информации о профиле (`account_info`)
- ✅ Все операции с уже авторизованными аккаунтами

### Что НЕ работает:
- ❌ Авторизация новых аккаунтов (`client.login()`)
- ❌ Endpoint `/api/v1/accounts/login/`

## Причина

Instagram определяет автоматизированные запросы на endpoint авторизации по:
1. **TLS fingerprint** - Python/instagrapi использует HTTP/1.1, браузер - HTTP/2/3
2. **User-Agent** - автоматизированные запросы имеют другой User-Agent
3. **Поведение** - автоматизированные запросы имеют другие заголовки и последовательность запросов

## Решение

### Вариант 1: Использовать готовые сессии (рекомендуется)
1. Авторизоваться в браузере через прокси
2. Экспортировать cookies из браузера
3. Импортировать сессию через API: `POST /api/accounts/{account_id}/import-session`

### Вариант 2: Обойти блокировку авторизации
- Использовать библиотеки с поддержкой HTTP/2 и TLS fingerprinting (curl_cffi, tls_client)
- Эмулировать браузерные заголовки и поведение
- Использовать прокси с ротацией IP

## Текущий статус

- ✅ Прокси работает для всех операций кроме авторизации
- ✅ Обновление профиля работает через прокси
- ❌ Авторизация новых аккаунтов блокируется
- ✅ Решение: использовать готовые сессии из браузера



